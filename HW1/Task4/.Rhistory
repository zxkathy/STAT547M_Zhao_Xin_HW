library(singer)
library(stringr)
library(ggmap)
library(leaflet)
library(dplyr)
singer_loc_noNA <-
singer_locations %>%
filter(!is.na(latitude), !is.na(longitude))
cities <- singer_loc_noNA %>%
dplyr::select(city, latitude, longitude, artist_hotttnesss)
leaflet(cities) %>% addTiles() %>%
addCircles(lng = ~longitude, lat = ~latitude, weight = 1,
radius = ~artist_hotttnesss * 3000, popup = ~city
)
city_name <- "new york"
state.abb[match(city_name, str_to_lower(state.name))] %>%
str_to_lower()
city_name <- "new"
state.abb[match(city_name, str_to_lower(state.name))] %>%
str_to_lower()
singer_loc
singer_loc_noNA
singer_loc
library(purrr)
library(repurrrsive)
library(singer)
library(stringr)
library(ggmap)
library(leaflet)
library(dplyr)
library(purrr)
library(repurrrsive)
library(singer)
library(stringr)
library(ggmap)
library(leaflet)
library(dplyr)
latlng_address <- function(longi, lati, output = "address") {
revgeocode(c(longi, lati), output = "address")
}
possibly_address <- possibly(latlng_address, "Address not found")
singer_loc_noNA <-
singer_locations %>%
filter(!is.na(latitude), !is.na(longitude), !is.na(city))
singer_loc <-
singer_loc_noNA %>%
head(25) %>%
mutate(addr = unlist(
purrr::map2(longitude, latitude, possibly_address)))
singer_loc_display <-
singer_loc %>%
head(15)%>%
dplyr::select(title, artist_name, artist_hotttnesss, city, addr)
singer_loc_display%>%
knitr::kable(digits = 2, align ="r", padding = 10)
singer_loc
latlng_address <- function(longi, lati, output = "address") {
revgeocode(c(longi, lati), output = "address")
}
possibly_address <- possibly(latlng_address, "Address not found")
singer_loc_noNA <-
singer_locations %>%
filter(!is.na(latitude), !is.na(longitude), !is.na(city))
singer_loc <-
singer_loc_noNA %>%
head(25) %>%
mutate(addr = unlist(
purrr::map2(longitude, latitude, possibly_address)))
latlng_address <- function(longi, lati, output = "address") {
revgeocode(c(longi, lati), output = "address")
}
possibly_address <- possibly(latlng_address, "Address not found")
singer_loc_noNA <-
singer_locations %>%
filter(!is.na(latitude), !is.na(longitude), !is.na(city))
singer_loc <-
singer_loc_noNA %>%
head(25) %>%
mutate(addr = unlist(
purrr::map2(longitude, latitude, possibly_address)))
singer_loc_noNA
latlng_address <- function(longi, lati, output = "address") {
revgeocode(c(longi, lati), output = "address")
}
possibly_address <- possibly(latlng_address, "Address not found")
singer_loc_noNA <-
singer_locations %>%
filter(!is.na(latitude), !is.na(longitude), !is.na(city))
singer_loc <-
singer_loc_noNA %>%
head(20) %>%
mutate(addr = unlist(
purrr::map2(longitude, latitude, possibly_address)))
singer_loc_display <-
singer_loc %>%
head(15)%>%
dplyr::select(title, artist_name, artist_hotttnesss, city, addr)
singer_loc_display%>%
knitr::kable(digits = 2, align ="r", padding = 10)
singer_loc_noNA
latlng_address(42.33168	, -83.04792)
latlng_address(42.33168, -83.04792)
latlng_address(42.33168, -83.04792)
latlng_address(42.33168, -83.04792)
latlng_address(42.33168, -83.04792)
latlng_address(42.33168, -83.04792)
singer_loc_noNA <-
singer_locations %>%
filter(!is.na(latitude), !is.na(longitude), !is.na(city))
latlng_address(42.33168, -83.04792)
latlng_address <- function(longi, lati, output = "address") {
revgeocode(c(longi, lati), output = "address")
}
possibly_address <- possibly(latlng_address, "Address not found")
singer_loc_noNA <-
singer_locations %>%
filter(!is.na(latitude), !is.na(longitude), !is.na(city))
singer_loc <-
singer_loc_noNA %>%
head(20) %>%
mutate(addr = unlist(
purrr::map2(longitude, latitude, possibly_address)))
latlng_address(42.33168, -83.04792)
latlng_address(42.33168, -83.04792)
latlng_address(42.33168, -83.04792)
latlng_address <- function(longi, lati, output = "address") {
revgeocode(c(longi, lati), output = "address")
}
possibly_address <- possibly(latlng_address, "Address not found")
singer_loc_noNA <-
singer_locations %>%
filter(!is.na(latitude), !is.na(longitude), !is.na(city))
singer_loc <-
singer_loc_noNA %>%
head(20) %>%
mutate(addr = unlist(
purrr::map2(longitude, latitude, possibly_address)))
singer_loc_display <-
singer_loc %>%
head(15)%>%
dplyr::select(title, artist_name, artist_hotttnesss, city, addr)
singer_loc_display%>%
knitr::kable(digits = 2, align ="r", padding = 10)
address <- singer_loc$addr[4]
city <- singer_loc$city[4]
address <- str_to_lower(address)
city <- str_to_lower(city)
is_match <- FALSE
if (str_detect(address, city)) {
is_match <- TRUE
}
is_match
token_address <- tokenize(address, trim = TRUE)
find_state_abb <- function(city_name){
state.abb[match(city_name, str_to_lower(state.name))] %>%
str_to_lower()
}
tokenize <- function(string, trim = FALSE) {
if (trim) {
string_trim <- str_trim(sub("^[^,]*,", "", string))
} else {
string_trim <- string
}
string_split <- unlist(str_split(string_trim, boundary("word")))
str_to_lower(string_split)
}
token_address <- tokenize(address, trim = TRUE)
token_address
token_city <- tokenize(city)
token_city
token_city_state <- find_state_abb(token_city)
token_city_state
address <- singer_loc$addr[5]
city <- singer_loc$city[5]
token_address <- tokenize(address, trim = TRUE)
token_city <- tokenize(city)
token_city_state <- find_state_abb(token_city)
token_city_state
token_city_state <- token_city_state[!is.na(token_city_state)]
token_city_state
city <- singer_loc$city[5]
singer_loc$addr
find_state_abb <- function(city_name){
state.abb[match(city_name, str_to_lower(state.name))] %>%
str_to_lower()
}
tokenize <- function(string, trim = FALSE) {
if (trim) {
string_trim <- str_trim(sub("^[^,]*,", "", string))
} else {
string_trim <- string
}
string_split <- unlist(str_split(string_trim, boundary("word")))
str_to_lower(string_split)
}
address <- singer_loc$addr[5]
city <- singer_loc$city[5]
city_state_match <- function(address, city) {
address <- str_to_lower(address)
city <- str_to_lower(city)
is_match <- FALSE
if (str_detect(address, city)) {
is_match <- TRUE
} else {
token_address <- tokenize(address, trim = TRUE)
token_city <- tokenize(city)
token_city_state <- find_state_abb(token_city)
token_city_state <- token_city_state[!is.na(token_city_state)]
new_token_city <- c(token_city, token_city_state)
token_match <- intersect(new_token_city, token_address)
if (length(token_match) != 0) {
is_match <- TRUE
}
}
is_match
}
singer_loc_full <-
singer_loc %>%
mutate(match_or_not =
unlist(map2(addr, city, city_state_match)))
singer_loc_full %>%
dplyr::select(title, artist_name, city, addr, match_or_not) %>%
knitr::kable(digits = 2, align ="r", padding = 10)
find_state_abb <- function(city_name){
state.abb[match(city_name, str_to_lower(state.name))] %>%
str_to_lower()
}
tokenize <- function(string, trim = FALSE) {
if (trim) {
string_trim <- str_trim(sub("^[^,]*,", "", string))
} else {
string_trim <- string
}
string_split <- unlist(str_split(string_trim, boundary("word")))
str_to_lower(string_split)
}
address <- singer_loc$addr[5]
city <- singer_loc$city[5]
city_state_match <- function(address, city) {
address <- str_to_lower(address)
city <- str_to_lower(city)
is_match <- FALSE
if (str_detect(address, city)) {
is_match <- TRUE
} else {
token_address <- tokenize(address, trim = TRUE)
token_city <- tokenize(city)
token_city_state <- find_state_abb(token_city)
token_city_state <- token_city_state[!is.na(token_city_state)]
new_token_city <- c(token_city, token_city_state)
token_match <- intersect(new_token_city, token_address)
if (length(token_match) != 0) {
is_match <- TRUE
}
}
is_match
}
singer_loc_full <-
singer_loc %>%
mutate(match_or_not =
unlist(map2(addr, city, city_state_match)))
singer_loc_full %>%
dplyr::select(title, artist_name, city, addr, match_or_not) %>%
knitr::kable(digits = 2, align ="r", padding = 10)
library(purrr)
library(repurrrsive)
library(singer)
library(stringr)
library(ggmap)
library(leaflet)
library(dplyr)
latlng_address <- function(longi, lati, output = "address") {
revgeocode(c(longi, lati), output = "address")
}
possibly_address <- possibly(latlng_address, "Address not found")
singer_loc_noNA <-
singer_locations %>%
filter(!is.na(latitude), !is.na(longitude), !is.na(city))
singer_loc <-
singer_loc_noNA %>%
head(20) %>%
mutate(addr = unlist(
purrr::map2(longitude, latitude, possibly_address)))
singer_loc_display <-
singer_loc %>%
head(15)%>%
dplyr::select(title, artist_name, artist_hotttnesss, city, addr)
singer_loc_display%>%
knitr::kable(digits = 2, align ="r", padding = 10)
latlng_address <- function(longi, lati, output = "address") {
revgeocode(c(longi, lati), output = "address")
}
possibly_address <- possibly(latlng_address, "Address not found")
singer_loc_noNA <-
singer_locations %>%
filter(!is.na(latitude), !is.na(longitude), !is.na(city))
singer_loc <-
singer_loc_noNA %>%
head(20) %>%
mutate(addr = unlist(
purrr::map2(longitude, latitude, possibly_address)))
singer_loc_display <-
singer_loc %>%
head(15)%>%
dplyr::select(title, artist_name, artist_hotttnesss, city, addr)
singer_loc_display%>%
knitr::kable(digits = 2, align ="r", padding = 10)
latlng_address <- function(longi, lati, output = "address") {
revgeocode(c(longi, lati), output = "address")
}
possibly_address <- possibly(latlng_address, "Address not found")
singer_loc_noNA <-
singer_locations %>%
filter(!is.na(latitude), !is.na(longitude), !is.na(city))
singer_loc <-
singer_loc_noNA %>%
head(25) %>%
mutate(addr = unlist(
purrr::map2(longitude, latitude, possibly_address))) %>%
filter(!is.na(addr))
singer_loc_display <-
singer_loc %>%
head(15)%>%
dplyr::select(title, artist_name, artist_hotttnesss, city, addr)
singer_loc_display%>%
knitr::kable(digits = 2, align ="r", padding = 10)
